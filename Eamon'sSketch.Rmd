---
title: "BeginAnalysis"
author: "Eamon"
date: "2024-12-18"
output: html_document
---
# Initialisation
## Set Up
### Load Libraries
```{r}
library(tidyverse)
library(corrplot) # For correlation plots
library(FactoMineR) # For PCA
library(factoextra) # For PCA plots
library(vegan) # For CCA
library(ggplot2)
```

### 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Clear environment
```{r}
rm(list = ls())
```


### Specify the FilePath and Read CSV
```{r}
path <- "/Users/eamon/Desktop/MathToolsProject/R_Project/MathematicalTools/lizard.csv"

# Read a CSV file
data <- read.csv(path)

# View the first few rows of the data
data
```

## Cleaning
### Rename the Columns
```{r}
# Rename multiple columns
colnames(data)[colnames(data) %in% 
                 c("Average.Female.adult.weight..g.", "SD.Female.adult.weight..g.", "Sample.Size.Female.adult.weight")] <- c("avg.female.adult.weight", "SD.female.adult.weight", "sample.size.female.adult.weight")
```


### Change Variables Types
```{r}
# Check the type of each column
sapply(data, class)

# Convert SD.Female.adult.weight..g. to numeric
data$SD.Female.adult.weight..g. <- as.numeric(data$SD.Female.adult.weight..g.)

# Convert categorical columns to factors
data$Species <- as.factor(data$Species)
data$Genus <- as.factor(data$Genus)
data$Family<- as.factor(data$Family)
data$Mode.of.reproduction <- as.factor(data$Mode.of.reproduction)
data$Foraging.Mode <- as.factor(data$Foraging.Mode)
data$Distribution <- as.factor(data$Distribution)
data$Prefered.Habitat.Type <- as.factor(data$Prefered.Habitat.Type)
```

### Check for and Remove Duplicates
```{r}
# Check for Duplicates
duplicates <- data[duplicated(data), ]
print("Duplicate Rows:")
print(duplicates)

# Remove duplicates
data <- data[!duplicated(data), ]
```

## NAs
### Check Amount of Data Loss If All NAs Removed
```{r}
data_clean <- na.omit(data)
nrow(data)
# Too many rows lost if all NAs removed
nrow(data_clean)
```

### Calculate Percentage of Each Variable Which Are NA
```{r}
# Calculate percentage of NA values for each column
na_percentage <- colSums(is.na(data)) / nrow(data) * 100

# Convert NA percentages to a data frame
na_df <- data.frame(
  Column = names(na_percentage),
  NA_Percentage = na_percentage
)

# Create bar plot
ggplot(na_df, aes(x = Column, y = NA_Percentage)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(
    title = "Percentage of NA Values per Column",
    x = "Columns",
    y = "Percentage (%)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1) # Rotate x-axis labels
  )
```
The following columns

# Visualisation
## Correlations
### CorrPlot
```{r}
data %>% 
  select_if(is.numeric) %>% # Select only numeric columns
  cor(use="pairwise.complete.obs") %>% # Calculate the empirical correlation matrix
  corrplot() # Then graph this matrix
```

# PCA
### Scale the Data
```{r}
data_scaled <- data %>% 
  select_if(is.numeric) %>% #Only numeric columns are selected
  mutate_all(.funs = scale)
head(data_scaled)
```
### 
```{r}

```



